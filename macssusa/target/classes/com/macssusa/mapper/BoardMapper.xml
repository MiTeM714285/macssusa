<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.macssusa.mapper.BoardMapper">

<!-- 게시글 번호 얻기(단순 auto-increment 속성이 아닌 게시글 수까지 파악가능) -->
<select id="getNextNum" resultType="Integer">
	SELECT IFNULL(MAX(bnum), 0) + 1 AS next_num FROM spr_board
</select>

<!-- 게시물 목록(기초) -->
<select id="getBoardList" parameterType="Integer" resultType="com.macssusa.model.BoardVO">
	select 
	bnum, btype, title, content, memberid, regdate, available, hitcount, replycnt, ip, filename1, filename2, filename3, filename4, filename5
	from spr_board
	where btype=#{btype} and available=1
	order by bnum desc
</select>

<!-- 게시물 목록(페이징 추가) -->
<select id="getBoardListPage" parameterType="hashMap" resultType="com.macssusa.model.BoardVO">
	select 
	bnum, btype, title, content, memberid, regdate, available, hitcount, replycnt, ip, filename1, filename2, filename3, filename4, filename5
	from spr_board
	where btype=#{btype} and available=1
	order by bnum desc
	limit #{displayPost}, #{postNum}
</select>

<!-- 게시글 갯수 -->
<select id="getBoardCount" parameterType="Integer" resultType="Integer">
	select count(*) from spr_board where btype=#{btype} and available=1
</select>

<!-- 게시글 쓰기 -->
<insert id="writeBoard">
	insert into spr_board(bnum, btype, title, content, memberid, regdate, available, hitcount, replycnt, ip, filename1, filename2, filename3, filename4, filename5) 
	values(#{bnum}, #{btype}, #{title}, #{content}, #{memberid}, now(), 1, 0, 0, #{ip}, #{filename1}, #{filename2}, #{filename3}, #{filename4}, #{filename5})
</insert>

<!-- 게시글 조회 -->
<select id="getBoardView" resultType="com.macssusa.model.BoardVO">
	select * from spr_board where bnum=#{bnum} and btype=#{btype}
</select>

<!-- 게시글 수정 -->
<update id="updateBoard" parameterType="com.macssusa.model.BoardVO">
	update spr_board 
	set title=#{title}, content=#{content}, filename1=#{filename1}, filename2=#{filename2}, filename3=#{filename3}, filename4=#{filename4}, filename5=#{filename5}
	where bnum=#{bnum}
</update>

<!-- 게시글 삭제(유저 입장) -->
<update id="deleteBoard" parameterType="Integer">
	update spr_board set available=0 where bnum=#{bnum}
</update>

</mapper>
  